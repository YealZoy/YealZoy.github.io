<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>istio 安装(二) | 郑菲菲_fei | 郑菲菲_fei</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="service Mesh,istio">
    <meta name="description" content="istio安装istio官网安装提供了多种方法，因为集群中包含helm，所以选择用helm安装istio  下载istio release(目前版本为0.8.0) 命令行执行helm install install/kubernetes/helm/istio --name istio --namespace istio-system(此命令采取自动注入sideCar)  istio的helm的va">
<meta name="keywords" content="service Mesh,istio">
<meta property="og:type" content="article">
<meta property="og:title" content="istio 安装(二)">
<meta property="og:url" content="https://www.zhengyuyan.com/201807/17/istio-install/index.html">
<meta property="og:site_name" content="郑菲菲_fei">
<meta property="og:description" content="istio安装istio官网安装提供了多种方法，因为集群中包含helm，所以选择用helm安装istio  下载istio release(目前版本为0.8.0) 命令行执行helm install install/kubernetes/helm/istio --name istio --namespace istio-system(此命令采取自动注入sideCar)  istio的helm的va">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://www.zhengyuyan.com/img/svc.png">
<meta property="og:image" content="https://www.zhengyuyan.com/img/grafana.png">
<meta property="og:image" content="https://www.zhengyuyan.com/img/jaeger-query.png">
<meta property="og:updated_time" content="2018-11-13T15:19:59.142Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="istio 安装(二)">
<meta name="twitter:description" content="istio安装istio官网安装提供了多种方法，因为集群中包含helm，所以选择用helm安装istio  下载istio release(目前版本为0.8.0) 命令行执行helm install install/kubernetes/helm/istio --name istio --namespace istio-system(此命令采取自动注入sideCar)  istio的helm的va">
<meta name="twitter:image" content="https://www.zhengyuyan.com/img/svc.png">
    
        <link rel="alternate" type="application/atom+xml" title="郑菲菲_fei" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">郑玉燕</h5>
          <a href="mailto:314186096@qq.com" title="314186096@qq.com" class="mail">314186096@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/YealZoy" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://weibo.com/coderzyy" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">istio 安装(二)</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">istio 安装(二)</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-07-17T13:28:42.000Z" itemprop="datePublished" class="page-time">
  2018-07-17
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/service-Mesh/">service Mesh</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#istio安装"><span class="post-toc-number">1.</span> <span class="post-toc-text">istio安装</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Mesh-Expansion"><span class="post-toc-number">2.</span> <span class="post-toc-text">Mesh Expansion</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Prometheus、Grafana-和-Zipkin"><span class="post-toc-number">3.</span> <span class="post-toc-text">Prometheus、Grafana 和 Zipkin</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#参考文档"><span class="post-toc-number">4.</span> <span class="post-toc-text">参考文档</span></a></li></ol>
        </nav>
    </aside>


<article id="post-istio-install"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">istio 安装(二)</h1>
        <div class="post-meta">
            <time class="post-time" title="2018-07-17 21:28:42" datetime="2018-07-17T13:28:42.000Z"  itemprop="datePublished">2018-07-17</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/service-Mesh/">service Mesh</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="istio安装"><a href="#istio安装" class="headerlink" title="istio安装"></a>istio安装</h1><p><a href="https://istio.io/docs/setup/" target="_blank" rel="noopener">istio官网安装</a>提供了多种方法，因为集群中包含helm，所以选择用helm安装istio</p>
<ul>
<li><a href="https://github.com/istio/istio/releases" target="_blank" rel="noopener">下载</a>istio release(目前版本为0.8.0)</li>
<li>命令行执行<code>helm install install/kubernetes/helm/istio --name istio --namespace istio-system</code>(此命令采取自动注入sideCar)</li>
</ul>
<p>istio的helm的value.yaml文件如下:<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Use --set or additional values.yaml file to configure settings.</span></span><br><span class="line"><span class="comment"># This file no longer uses sed, updateVersions.sh or istio.VERSIONS</span></span><br><span class="line"><span class="comment"># <span class="doctag">TODO:</span> evaluate if we need individual overrides for each component version, istio</span></span><br><span class="line"><span class="comment"># is not typically tested with a mix of versions. Only supported case is version upgrade.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Common settings.</span></span><br><span class="line"><span class="attr">global:</span></span><br><span class="line">  <span class="comment"># Default repository for Istio images.</span></span><br><span class="line">  <span class="comment"># Releases are published to docker hub under 'istio' project.</span></span><br><span class="line">  <span class="comment"># Daily builds from prow are on gcr.io, and nightly builds from circle on</span></span><br><span class="line">  <span class="comment"># docker.io/istionightly</span></span><br><span class="line"><span class="attr">  hub:</span> <span class="number">192.168</span><span class="number">.30</span><span class="number">.100</span><span class="string">:8889/istio</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Default tag for Istio images.</span></span><br><span class="line">  <span class="comment"># Should track latest released version in the branch.</span></span><br><span class="line"><span class="attr">  tag:</span> <span class="number">0.8</span><span class="number">.0</span></span><br><span class="line"><span class="attr">  proxy:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">proxyv2</span></span><br><span class="line"><span class="attr">    resources:</span></span><br><span class="line"><span class="attr">      requests:</span></span><br><span class="line"><span class="attr">        cpu:</span> <span class="number">100</span><span class="string">m</span></span><br><span class="line"><span class="attr">        memory:</span> <span class="number">128</span><span class="string">Mi</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># istio-sidecar-injector configmap stores configuration for sidecar injection.</span></span><br><span class="line">    <span class="comment"># This config map is used by istioctl kube-inject and the injector webhook.</span></span><br><span class="line"><span class="attr">    enableCoreDump:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    serviceAccountName:</span> <span class="string">default</span> <span class="comment"># used only if RBAC is not enabled</span></span><br><span class="line"><span class="attr">    replicaCount:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">    resources:</span></span><br><span class="line"><span class="attr">      requests:</span></span><br><span class="line"><span class="attr">        cpu:</span> <span class="number">100</span><span class="string">m</span></span><br><span class="line"><span class="attr">        memory:</span> <span class="number">128</span><span class="string">Mi</span></span><br><span class="line">    <span class="comment"># limits:</span></span><br><span class="line">    <span class="comment">#  cpu: 100m</span></span><br><span class="line">    <span class="comment">#  memory: 128Mi</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># istio egress capture whitelist</span></span><br><span class="line">    <span class="comment"># https://istio.io/docs/tasks/traffic-management/egress.html#calling-external-services-directly</span></span><br><span class="line">    <span class="comment"># example: includeIPRanges: "172.30.0.0/16,172.20.0.0/16"</span></span><br><span class="line">    <span class="comment"># would only capture egress traffic on those two IP Ranges, all other outbound traffic would</span></span><br><span class="line">    <span class="comment"># be allowed by the sidecar</span></span><br><span class="line"><span class="attr">    includeIPRanges:</span> <span class="string">"*"</span></span><br><span class="line"><span class="attr">    excludeIPRanges:</span> <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># istio ingress capture whitelist</span></span><br><span class="line">    <span class="comment"># examples:</span></span><br><span class="line">    <span class="comment">#     Redirect no inbound traffic to Envoy:    --includeInboundPorts=""</span></span><br><span class="line">    <span class="comment">#     Redirect all inbound traffic to Envoy:   --includeInboundPorts="*"</span></span><br><span class="line">    <span class="comment">#     Redirect only selected ports:            --includeInboundPorts="80,8080"</span></span><br><span class="line"><span class="attr">    includeInboundPorts:</span> <span class="string">"*"</span></span><br><span class="line"><span class="attr">    excludeInboundPorts:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">    policy:</span> <span class="string">enabled</span></span><br><span class="line"></span><br><span class="line"><span class="attr">  proxy_init:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">proxy_init</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># imagePullPolicy is applied to istio control plane components.</span></span><br><span class="line">  <span class="comment"># local tests require IfNotPresent, to avoid uploading to dockerhub.</span></span><br><span class="line">  <span class="comment"># <span class="doctag">TODO:</span> Switch to Always as default, and override in the local tests.</span></span><br><span class="line"><span class="attr">  imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Not recommended for user to configure this. Hyperkube image to use when creating custom resources</span></span><br><span class="line"><span class="attr">  hyperkube:</span></span><br><span class="line"><span class="attr">    repository:</span> <span class="number">192.168</span><span class="number">.30</span><span class="number">.100</span><span class="string">:8889/coreos/hyperkube</span></span><br><span class="line"><span class="attr">    tag:</span> <span class="string">v1.7.6_coreos.0</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># controlPlaneMtls enabled. Will result in delays starting the pods while secrets are</span></span><br><span class="line">  <span class="comment"># propagated, not recommended for tests.</span></span><br><span class="line"><span class="attr">  controlPlaneSecurityEnabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Default mtls policy. If true, mtls between services will be enabled by default.</span></span><br><span class="line"><span class="attr">  mtls:</span></span><br><span class="line">    <span class="comment"># Default setting for service-to-service mtls. Can be set explicitly using</span></span><br><span class="line">    <span class="comment"># destination rules or service annotations.</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># List of fully qualified services to exclude from mtls</span></span><br><span class="line">    <span class="comment"># <span class="doctag">TODO:</span> add the templating.</span></span><br><span class="line"><span class="attr">    mtlsExcludedServices:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">"kubernetes.default.svc.cluster.local"</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># create RBAC resources. Must be set for any cluster configured with rbac.</span></span><br><span class="line"><span class="attr">  rbacEnabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">## imagePullSecrets for all ServiceAccount. Must be set for any clustser configured with privte docker registry.</span></span><br><span class="line">  <span class="comment"># imagePullSecrets:</span></span><br><span class="line">  <span class="comment">#   - name: "private-registry-key"</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Default is 1 second</span></span><br><span class="line"><span class="attr">  refreshInterval:</span> <span class="number">10</span><span class="string">s</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Enable multicluster operation.  Must be set to true if multicluster operation</span></span><br><span class="line">  <span class="comment"># is desired.</span></span><br><span class="line"><span class="attr">  multicluster:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Specify pod scheduling arch(amd64, ppc64le, s390x) and weight as follows:</span></span><br><span class="line">  <span class="comment">#   0 - Never scheduled</span></span><br><span class="line">  <span class="comment">#   1 - Least preferred</span></span><br><span class="line">  <span class="comment">#   2 - No preference</span></span><br><span class="line">  <span class="comment">#   3 - Most preferred</span></span><br><span class="line"><span class="attr">  arch:</span></span><br><span class="line"><span class="attr">    amd64:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">    s390x:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">    ppc64le:</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Any customization for istio testing should be here</span></span><br><span class="line"><span class="attr">istiotesting:</span></span><br><span class="line"><span class="attr">  oneNameSpace:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># ingress configuration</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="attr">ingress:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  serviceAccountName:</span> <span class="string">default</span></span><br><span class="line"><span class="attr">  autoscaleMin:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  autoscaleMax:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line"><span class="comment"># limits:</span></span><br><span class="line"><span class="comment">#  cpu: 100m</span></span><br><span class="line"><span class="comment">#  memory: 128Mi</span></span><br><span class="line"><span class="comment"># requests:</span></span><br><span class="line"><span class="comment">#  cpu: 100m</span></span><br><span class="line"><span class="comment">#  memory: 128Mi</span></span><br><span class="line"><span class="attr">  service:</span></span><br><span class="line"><span class="attr">    loadBalancerIP:</span> <span class="string">"10.100.100.20"</span></span><br><span class="line"><span class="attr">    type:</span> <span class="string">LoadBalancer</span> <span class="comment">#change to NodePort, ClusterIP or LoadBalancer if need be</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="attr">    - port:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">      name:</span> <span class="string">http</span></span><br><span class="line"><span class="attr">      nodePort:</span> <span class="number">32000</span></span><br><span class="line"><span class="attr">    - port:</span> <span class="number">443</span></span><br><span class="line"><span class="attr">      name:</span> <span class="string">https</span></span><br><span class="line"><span class="attr">    selector:</span></span><br><span class="line"><span class="attr">      istio:</span> <span class="string">ingress</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># ingressgateway configuration</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="attr">ingressgateway:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  serviceAccountName:</span> <span class="string">istio-ingressgateway-service-account</span></span><br><span class="line"><span class="attr">  autoscaleMin:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  autoscaleMax:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line"><span class="comment"># limits:</span></span><br><span class="line"><span class="comment">#  cpu: 100m</span></span><br><span class="line"><span class="comment">#  memory: 128Mi</span></span><br><span class="line"><span class="comment"># requests:</span></span><br><span class="line"><span class="comment">#  cpu: 100m</span></span><br><span class="line"><span class="comment">#  memory: 128Mi</span></span><br><span class="line"><span class="attr">  service:</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">istio-ingressgateway</span> <span class="comment">#DNS addressible</span></span><br><span class="line"><span class="attr">    labels:</span></span><br><span class="line"><span class="attr">      istio:</span> <span class="string">ingressgateway</span></span><br><span class="line">    <span class="comment">#namespace: istio-system</span></span><br><span class="line"><span class="attr">    loadBalancerIP:</span> <span class="string">"10.100.100.129"</span></span><br><span class="line"><span class="attr">    type:</span> <span class="string">LoadBalancer</span> <span class="comment">#change to NodePort, ClusterIP or LoadBalancer if need be</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line">      <span class="comment">## You can add custom gateway ports</span></span><br><span class="line"><span class="attr">    - port:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">      name:</span> <span class="string">http</span></span><br><span class="line"><span class="attr">      nodePort:</span> <span class="number">31380</span></span><br><span class="line"><span class="attr">    - port:</span> <span class="number">443</span></span><br><span class="line"><span class="attr">      name:</span> <span class="string">https</span></span><br><span class="line"><span class="attr">      nodePort:</span> <span class="number">31390</span></span><br><span class="line"><span class="attr">    - port:</span> <span class="number">31400</span></span><br><span class="line"><span class="attr">      name:</span> <span class="string">tcp</span></span><br><span class="line"><span class="attr">      nodePort:</span> <span class="number">31400</span></span><br><span class="line"><span class="attr">  deployment:</span></span><br><span class="line"><span class="attr">    labels:</span></span><br><span class="line"><span class="attr">      istio:</span> <span class="string">ingressgateway</span> <span class="comment">#will be added to pods and service</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="attr">    - containerPort:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">    - containerPort:</span> <span class="number">443</span></span><br><span class="line"><span class="attr">    - containerPort:</span> <span class="number">31400</span></span><br><span class="line"><span class="attr">    secretVolumes:</span></span><br><span class="line"><span class="attr">    - name:</span> <span class="string">ingressgateway-certs</span></span><br><span class="line"><span class="attr">      secretName:</span> <span class="string">istio-ingressgateway-certs</span></span><br><span class="line"><span class="attr">      mountPath:</span> <span class="string">/etc/istio/ingressgateway-certs</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># egressgateway configuration</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="attr">egressgateway:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  serviceAccountName:</span> <span class="string">istio-egressgateway-service-account</span></span><br><span class="line"><span class="attr">  autoscaleMin:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  autoscaleMax:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line"><span class="comment"># limits:</span></span><br><span class="line"><span class="comment">#  cpu: 100m</span></span><br><span class="line"><span class="comment">#  memory: 128Mi</span></span><br><span class="line"><span class="comment"># requests:</span></span><br><span class="line"><span class="comment">#  cpu: 100m</span></span><br><span class="line"><span class="comment">#  memory: 128Mi</span></span><br><span class="line"><span class="attr">  service:</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">istio-egressgateway</span> <span class="comment">#DNS addressible</span></span><br><span class="line"><span class="attr">    labels:</span></span><br><span class="line"><span class="attr">      istio:</span> <span class="string">egressgateway</span></span><br><span class="line">    <span class="comment">#namespace: istio-system</span></span><br><span class="line"><span class="attr">    type:</span> <span class="string">ClusterIP</span> <span class="comment">#change to NodePort or LoadBalancer if need be</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line">      <span class="comment">## You can add custom gateway ports</span></span><br><span class="line"><span class="attr">    - port:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">      name:</span> <span class="string">http</span></span><br><span class="line"><span class="attr">    - port:</span> <span class="number">443</span></span><br><span class="line"><span class="attr">      name:</span> <span class="string">https</span></span><br><span class="line"><span class="attr">  deployment:</span></span><br><span class="line"><span class="attr">    labels:</span></span><br><span class="line"><span class="attr">      istio:</span> <span class="string">egressgateway</span> <span class="comment">#will be added to pods and service</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="attr">    - containerPort:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">    - containerPort:</span> <span class="number">443</span></span><br><span class="line">  <span class="comment"># secretVolumes: TODO</span></span><br><span class="line">  <span class="comment"># - name: someName</span></span><br><span class="line">  <span class="comment">#   mountPath: somePath</span></span><br><span class="line">  <span class="comment">#   secretName: someName</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># sidecar-injector webhook configuration</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="attr">sidecarInjectorWebhook:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  image:</span> <span class="string">sidecar_injector</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># galley configuration</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="attr">galley:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">  serviceAccountName:</span> <span class="string">default</span></span><br><span class="line"><span class="attr">  replicaCount:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  image:</span> <span class="string">galley</span></span><br><span class="line"><span class="attr">  resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment"># limits:</span></span><br><span class="line">  <span class="comment">#  cpu: 100m</span></span><br><span class="line">  <span class="comment">#  memory: 128Mi</span></span><br><span class="line">  <span class="comment"># requests:</span></span><br><span class="line">  <span class="comment">#  cpu: 100m</span></span><br><span class="line">  <span class="comment">#  memory: 128Mi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># mixer configuration</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="attr">mixer:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  serviceAccountName:</span> <span class="string">default</span> <span class="comment"># used only if RBAC is not enabled</span></span><br><span class="line"><span class="attr">  replicaCount:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  image:</span> <span class="string">mixer</span></span><br><span class="line"><span class="attr">  resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment"># limits:</span></span><br><span class="line">  <span class="comment">#  cpu: 100m</span></span><br><span class="line">  <span class="comment">#  memory: 128Mi</span></span><br><span class="line">  <span class="comment"># requests:</span></span><br><span class="line">  <span class="comment">#  cpu: 100m</span></span><br><span class="line">  <span class="comment">#  memory: 128Mi</span></span><br><span class="line"></span><br><span class="line"><span class="attr">  prometheusStatsdExporter:</span></span><br><span class="line"><span class="attr">    repository:</span> <span class="number">192.168</span><span class="number">.30</span><span class="number">.100</span><span class="string">:8889/prom/statsd-exporter</span></span><br><span class="line"><span class="attr">    tag:</span> <span class="string">latest</span></span><br><span class="line"><span class="attr">    resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># pilot configuration</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="attr">pilot:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  serviceAccountName:</span> <span class="string">default</span> <span class="comment"># used only if RBAC is not enabled</span></span><br><span class="line"><span class="attr">  replicaCount:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  image:</span> <span class="string">pilot</span></span><br><span class="line"><span class="attr">  resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment"># limits:</span></span><br><span class="line">  <span class="comment">#  cpu: 100m</span></span><br><span class="line">  <span class="comment">#  memory: 128Mi</span></span><br><span class="line">  <span class="comment"># requests:</span></span><br><span class="line">  <span class="comment">#  cpu: 100m</span></span><br><span class="line">  <span class="comment">#  memory: 128Mi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># security configuration</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="attr">security:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  serviceAccountName:</span> <span class="string">default</span> <span class="comment"># used only if RBAC is not enabled</span></span><br><span class="line"><span class="attr">  replicaCount:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  image:</span> <span class="string">citadel</span></span><br><span class="line"><span class="attr">  resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment"># limits:</span></span><br><span class="line">  <span class="comment">#  cpu: 100m</span></span><br><span class="line">  <span class="comment">#  memory: 128Mi</span></span><br><span class="line">  <span class="comment"># requests:</span></span><br><span class="line">  <span class="comment">#  cpu: 100m</span></span><br><span class="line">  <span class="comment">#  memory: 128Mi</span></span><br><span class="line"><span class="attr">  cleanUpOldCA:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># addons configuration</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="attr">grafana:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  replicaCount:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  image:</span> <span class="string">grafana</span></span><br><span class="line"><span class="attr">  service:</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">http</span></span><br><span class="line"><span class="attr">    type:</span> <span class="string">ClusterIP</span></span><br><span class="line"><span class="attr">    externalPort:</span> <span class="number">3000</span></span><br><span class="line"><span class="attr">    internalPort:</span> <span class="number">3000</span></span><br><span class="line"><span class="attr">  ingress:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># Used to create an Ingress record.</span></span><br><span class="line"><span class="attr">    hosts:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">grafana.local</span></span><br><span class="line"><span class="attr">    annotations:</span></span><br><span class="line">      <span class="comment"># kubernetes.io/ingress.class: nginx</span></span><br><span class="line">      <span class="comment"># kubernetes.io/tls-acme: "true"</span></span><br><span class="line"><span class="attr">    tls:</span></span><br><span class="line">      <span class="comment"># Secrets must be manually created in the namespace.</span></span><br><span class="line">      <span class="comment"># - secretName: grafana-tls</span></span><br><span class="line">      <span class="comment">#   hosts:</span></span><br><span class="line">      <span class="comment">#     - grafana.local</span></span><br><span class="line"></span><br><span class="line"><span class="attr">  resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">    <span class="comment"># limits:</span></span><br><span class="line">    <span class="comment">#  cpu: 100m</span></span><br><span class="line">    <span class="comment">#  memory: 128Mi</span></span><br><span class="line">    <span class="comment"># requests:</span></span><br><span class="line">    <span class="comment">#  cpu: 100m</span></span><br><span class="line">    <span class="comment">#  memory: 128Mi</span></span><br><span class="line"></span><br><span class="line"><span class="attr">prometheus:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  replicaCount:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  image:</span></span><br><span class="line"><span class="attr">    repository:</span> <span class="number">192.168</span><span class="number">.30</span><span class="number">.100</span><span class="string">:8889/prom/prometheus</span></span><br><span class="line"><span class="attr">    tag:</span> <span class="string">latest</span></span><br><span class="line"><span class="attr">  ingress:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># Used to create an Ingress record.</span></span><br><span class="line">    <span class="comment">#hosts:</span></span><br><span class="line">    <span class="comment">#  - prometheus.local</span></span><br><span class="line"><span class="attr">    annotations:</span></span><br><span class="line">      <span class="comment"># kubernetes.io/ingress.class: nginx</span></span><br><span class="line">      <span class="comment"># kubernetes.io/tls-acme: "true"</span></span><br><span class="line"><span class="attr">    tls:</span></span><br><span class="line">      <span class="comment"># Secrets must be manually created in the namespace.</span></span><br><span class="line">      <span class="comment"># - secretName: prometheus-tls</span></span><br><span class="line">      <span class="comment">#   hosts:</span></span><br><span class="line">      <span class="comment">#     - prometheus.local</span></span><br><span class="line"><span class="attr">  resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">    <span class="comment"># limits:</span></span><br><span class="line">    <span class="comment">#  cpu: 100m</span></span><br><span class="line">    <span class="comment">#  memory: 128Mi</span></span><br><span class="line">    <span class="comment"># requests:</span></span><br><span class="line">    <span class="comment">#  cpu: 100m</span></span><br><span class="line">    <span class="comment">#  memory: 128Mi</span></span><br><span class="line"><span class="attr">  service:</span></span><br><span class="line"><span class="attr">    nodePort:</span></span><br><span class="line"><span class="attr">      enabled:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">      port:</span> <span class="number">32090</span></span><br><span class="line"></span><br><span class="line"><span class="attr">servicegraph:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  replicaCount:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  image:</span> <span class="string">servicegraph</span></span><br><span class="line"><span class="attr">  service:</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">http</span></span><br><span class="line"><span class="attr">    type:</span> <span class="string">ClusterIP</span></span><br><span class="line"><span class="attr">    externalPort:</span> <span class="number">8088</span></span><br><span class="line"><span class="attr">    internalPort:</span> <span class="number">8088</span></span><br><span class="line"><span class="attr">  ingress:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># Used to create an Ingress record.</span></span><br><span class="line"><span class="attr">    hosts:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">servicegraph.local</span></span><br><span class="line"><span class="attr">    annotations:</span></span><br><span class="line">      <span class="comment"># kubernetes.io/ingress.class: nginx</span></span><br><span class="line">      <span class="comment"># kubernetes.io/tls-acme: "true"</span></span><br><span class="line"><span class="attr">    tls:</span></span><br><span class="line">      <span class="comment"># Secrets must be manually created in the namespace.</span></span><br><span class="line">      <span class="comment"># - secretName: servicegraph-tls</span></span><br><span class="line">      <span class="comment">#   hosts:</span></span><br><span class="line">      <span class="comment">#     - servicegraph.local</span></span><br><span class="line"><span class="attr">  resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">    <span class="comment"># limits:</span></span><br><span class="line">    <span class="comment">#  cpu: 100m</span></span><br><span class="line">    <span class="comment">#  memory: 128Mi</span></span><br><span class="line">    <span class="comment"># requests:</span></span><br><span class="line">    <span class="comment">#  cpu: 100m</span></span><br><span class="line">    <span class="comment">#  memory: 128Mi</span></span><br><span class="line">  <span class="comment"># prometheus addres</span></span><br><span class="line"><span class="attr">  prometheusAddr:</span> <span class="attr">http://prometheus:9090</span></span><br><span class="line"></span><br><span class="line"><span class="attr">tracing:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  jaeger:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    memory:</span></span><br><span class="line"><span class="attr">      max_traces:</span> <span class="number">50000</span></span><br><span class="line"><span class="attr">  replicaCount:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  image:</span></span><br><span class="line"><span class="attr">    repository:</span> <span class="number">192.168</span><span class="number">.30</span><span class="number">.100</span><span class="string">:8889/jaegertracing/all-in-one</span></span><br><span class="line"><span class="attr">    tag:</span> <span class="number">1.5</span></span><br><span class="line"><span class="attr">  service:</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">http</span></span><br><span class="line"><span class="attr">    type:</span> <span class="string">ClusterIP</span></span><br><span class="line"><span class="attr">    externalPort:</span> <span class="number">9411</span></span><br><span class="line"><span class="attr">    internalPort:</span> <span class="number">9411</span></span><br><span class="line"><span class="attr">    uiPort:</span> <span class="number">16686</span></span><br><span class="line"><span class="attr">  ingress:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># Used to create an Ingress record.</span></span><br><span class="line"><span class="attr">    hosts:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">zipkin.local</span></span><br><span class="line"><span class="attr">    annotations:</span></span><br><span class="line">      <span class="comment"># kubernetes.io/ingress.class: nginx</span></span><br><span class="line">      <span class="comment"># kubernetes.io/tls-acme: "true"</span></span><br><span class="line"><span class="attr">    tls:</span></span><br><span class="line">      <span class="comment"># Secrets must be manually created in the namespace.</span></span><br><span class="line">      <span class="comment"># - secretName: zipkin-tls</span></span><br><span class="line">      <span class="comment">#   hosts:</span></span><br><span class="line">      <span class="comment">#     - zipkin.local</span></span><br><span class="line"><span class="attr">  resources:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">    <span class="comment"># limits:</span></span><br><span class="line">    <span class="comment">#  cpu: 100m</span></span><br><span class="line">    <span class="comment">#  memory: 128Mi</span></span><br><span class="line">    <span class="comment"># requests:</span></span><br><span class="line">    <span class="comment">#  cpu: 100m</span></span><br><span class="line">    <span class="comment">#  memory: 128Mi</span></span><br></pre></td></tr></table></figure></p>
<p>主要修改了镜像地址和将以些默认不安装的addon设置为安装(<code>grafana</code>,<code>servicegraph</code>,<code>tracing</code>)<br>安装成功之后<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/svc.png" alt="istio svc" title="">
                </div>
                <div class="image-caption">istio svc</div>
            </figure><br><strong><em>为了避免ingressgate-way所在的机子80端口被占用，特申请一台ingressgate-way的IP地址相同机子</em></strong><br><br><strong><em>在dns里添加了主机域名</em></strong></p>
<h1 id="Mesh-Expansion"><a href="#Mesh-Expansion" class="headerlink" title="Mesh Expansion"></a>Mesh Expansion</h1><p>Istio 还支持管理非 Kubernetes 管理的应用。此时，需要在应用所在的 VM 或者物理中部署 Istio，具体步骤请参考 <a href="https://istio.io/docs/setup/kubernetes/mesh-expansion.html。" target="_blank" rel="noopener">https://istio.io/docs/setup/kubernetes/mesh-expansion.html。</a><br>部署好后，就可以向 Istio 注册应用，如<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># istioctl register servicename machine-ip portname:port</span></span><br><span class="line"><span class="string">istioctl</span> <span class="bullet">-n</span> <span class="string">onprem</span> <span class="string">register</span> <span class="string">mysql</span> <span class="number">1.2</span><span class="number">.3</span><span class="number">.4</span> <span class="number">3306</span></span><br><span class="line"><span class="string">istioctl</span> <span class="bullet">-n</span> <span class="string">onprem</span> <span class="string">register</span> <span class="string">svc1</span> <span class="number">1.2</span><span class="number">.3</span><span class="number">.4</span> <span class="attr">http:7000</span></span><br></pre></td></tr></table></figure></p>
<h1 id="Prometheus、Grafana-和-Zipkin"><a href="#Prometheus、Grafana-和-Zipkin" class="headerlink" title="Prometheus、Grafana 和 Zipkin"></a>Prometheus、Grafana 和 Zipkin</h1><p>等所有 Pod 启动后，可以通过 NodePort、负载均衡服务的外网 IP 或者 kubectl proxy 来访问这些服务或者创建一个istio的VirtualService。<br><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Gateway</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">istio-gateway</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  selector:</span></span><br><span class="line"><span class="attr">    istio:</span> <span class="string">ingressgateway</span> <span class="comment"># use istio default controller</span></span><br><span class="line"><span class="attr">  servers:</span></span><br><span class="line"><span class="attr">  - port:</span></span><br><span class="line"><span class="attr">      number:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">      name:</span> <span class="string">http</span></span><br><span class="line"><span class="attr">      protocol:</span> <span class="string">HTTP</span></span><br><span class="line"><span class="attr">    hosts:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">"prom.example.com"</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">"grafana.example.com"</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">"pilot.example.com"</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">"zipkin.example.com"</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">VirtualService</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">grafana</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  hosts:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">"grafana.example.com"</span></span><br><span class="line"><span class="attr">  gateways:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">istio-gateway</span></span><br><span class="line"><span class="attr">  http:</span></span><br><span class="line"><span class="attr">  - route:</span></span><br><span class="line"><span class="attr">    - destination:</span></span><br><span class="line"><span class="attr">        host:</span> <span class="string">grafana.istio-system.svc.cluster.local</span></span><br><span class="line"><span class="attr">        port:</span></span><br><span class="line"><span class="attr">          number:</span> <span class="number">3000</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">VirtualService</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">prom</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  hosts:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">"prom.example.com"</span></span><br><span class="line"><span class="attr">  gateways:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">istio-gateway</span></span><br><span class="line"><span class="attr">  http:</span></span><br><span class="line"><span class="attr">  - route:</span></span><br><span class="line"><span class="attr">    - destination:</span></span><br><span class="line"><span class="attr">        host:</span> <span class="string">prometheus.istio-system.svc.cluster.local</span></span><br><span class="line"><span class="attr">        port:</span></span><br><span class="line"><span class="attr">          number:</span> <span class="number">9090</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure></p>
<p>通过 <code>http://grafana.example.com</code> 访问 Grafana 服务<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/grafana.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>通过loabblancer访问jaeger-query,展示服务之间调用关系图<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/jaeger-query.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://istio.io/docs/setup/kubernetes/helm-install/" target="_blank" rel="noopener">官方istio安装</a><br><a href="https://kubernetes.feisky.xyz/zh/apps/istio-deploy.html" target="_blank" rel="noopener">istio安装</a></p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2018-11-13T15:19:59.142Z" itemprop="dateUpdated">2018-11-13 23:19:59</time>
</span><br>


        
        <a href="/201807/17/istio-install/" target="_blank" rel="external">https://www.zhengyuyan.com/201807/17/istio-install/</a>
        
    </div>
    
    <footer>
        <a href="https://www.zhengyuyan.com">
            <img src="/img/avatar.jpg" alt="郑玉燕">
            郑玉燕
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/istio/">istio</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/service-Mesh/">service Mesh</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.zhengyuyan.com/201807/17/istio-install/&title=《istio 安装(二)》 — 郑菲菲_fei&pic=https://www.zhengyuyan.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.zhengyuyan.com/201807/17/istio-install/&title=《istio 安装(二)》 — 郑菲菲_fei&source=郑菲菲_fei的个人博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://www.zhengyuyan.com/201807/17/istio-install/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《istio 安装(二)》 — 郑菲菲_fei&url=https://www.zhengyuyan.com/201807/17/istio-install/&via=https://www.zhengyuyan.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://www.zhengyuyan.com/201807/17/istio-install/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/201807/17/bookinfo/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">istio官方示例bookinfo</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/201807/17/istio-brief/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">istio简介(一)</h4>
      </a>
    </div>
  
</nav>



    











    <!-- Valine Comments -->
    <div class="comments vcomment" id="comments"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            el: '#comments',
            notify: 'false' == 'true',
            verify: 'false' == 'true',
            appId: "S3HLoEkJ1TFJVllqfhemwIga-gzGzoHsz",
            appKey: "kJv3mIkUwGVWvnoRXGmUKL5I",
            avatar: "mm",
            placeholder: "Just go go",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->







</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>郑玉燕 &copy; 2015 - 2019</span>
            <span>
                
                <a href="http://www.miitbeian.gov.cn/" target="_blank">京ICP备16003165号-1</a><br>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.zhengyuyan.com/201807/17/istio-install/&title=《istio 安装(二)》 — 郑菲菲_fei&pic=https://www.zhengyuyan.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.zhengyuyan.com/201807/17/istio-install/&title=《istio 安装(二)》 — 郑菲菲_fei&source=郑菲菲_fei的个人博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://www.zhengyuyan.com/201807/17/istio-install/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《istio 安装(二)》 — 郑菲菲_fei&url=https://www.zhengyuyan.com/201807/17/istio-install/&via=https://www.zhengyuyan.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://www.zhengyuyan.com/201807/17/istio-install/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLElEQVR42u3aQW7DMAwF0dz/0um6KKzMJ+0iosYrI3AsvgQgKFKvF77e+Lp6fv3Oq09uvmTIkLEtIw3r73d5WLX7dWwyZMg4h3GVwdb36/fwH4is+yFmGTJkyMCplqfg2royZMiQ0WeQPSZJ0DJkyJDRKeDWG1r+Bv6tm/fiMmTI2JDBu+7/f//IfEOGDBlbMd7h1eelg0wUlQwZMkYzeIKrNdR46OlhCxkyZJzD6CQ7PrxMi07+/htytgwZMr6eQV7N024aIm+x1UYRMmTImMToNOXJeIAn4mJilSFDxmhGulga9HMb3V/3MmTIGM2opTyyfG1zS54vbl9lyJAxiEG2oLXjWWlSJoz4n5EhQ8a2DL59rZVuxclqOkKQIUPGUMa9zfp+0ZkOJ4L/QYYMGdsyeFMsTb68fEwPZMQVqAwZMsYx+sPOtAHH22poRRkyZBzASA+wpke4eHC1AacMGTKmMvhAMW3ZdzbDJDXLkCHjZAZPtbUGWT8Fo9pWhgwZQxmkoXbvM4SKemsyZMg4hkEaZOSQVie9pq06GTJknMMgpR7/pFNK1oYTMmTImMroDAPSoxtpug/WlSFDxmjGDdkajx5raZ2UmzJkyDiBkSbZoAVWSsTFH0WGDBkHMNYBrdtnaYu/U/Z9ONcmQ4YMGaW0yDexrRpWhgwZMsLDqby1l0YYHGCVIUPGOEZa8PFWfropfbzdJkOGjA0ZnbqLN/3TwxY8xcuQIWM04wccr0upuZ6V0wAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
